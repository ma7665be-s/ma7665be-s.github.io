<!DOCTYPE html>

<html>
  <head>
    <title>Looper</title>
    <link rel="stylesheet" href="styles.css">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>

  <body>
    <canvas id="canvas"></canvas>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    <script src="https://cdn.babylonjs.com/babylon.max.js"></script>
    <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script src="gameScript.js"></script>
    <script type="application/vertexShader" id="vertexShaderCode">
    precision highp float;

    // Attributes
    attribute vec3 position;
    attribute vec3 normal;
    attribute vec2 uv;
    // Uniforms
    uniform mat4 worldViewProjection;
    uniform mat4 world;
    uniform vec3 lightposition;
    uniform vec3 lightdirection;
    uniform vec3 cameraposition;
    // Output
    out vec2 vUV;
    out vec3 n;
    out vec3 lp;
    out vec3 ld;
    out vec3 wp;
    out vec3 cp;
    out vec3 vd;
    void main(void) {
    gl_Position = worldViewProjection * vec4(position, 1.0);
    vUV = uv;
    lp = lightposition;
    cp = cameraposition;
    n = normalize((world*vec4(normal,0.0)).xyz);
    wp = (world*vec4(position,1.0)).xyz;
    ld = normalize(lp - wp);
    vd = normalize(cp - wp);

    }
</script>
<script type="application/fragmentShader" id="fragmentShaderCode">
    precision mediump float;
    // Input
    in vec3 n;
    in vec3 lp;
    in vec3 ld;
    in vec3 vd;

    float shininess = 2.0;
    vec3 ambient = vec3(0.1,0.0,0.0);
    vec3 diffuse = vec3(0.8,0.0,0.0);
    vec3 specular = vec3(0.8,0.8,0.8);

    void main(void) {
      vec3 r = normalize(reflect(-ld, n));
      vec3 amb = ambient;
      vec3 dif = diffuse*max(dot(n,ld),0.0);
      vec3 spe = specular*pow(max(dot(r,vd), 0.0), shininess);
      gl_FragColor = vec4(amb+dif+spe, 1.0);
    }
</script>
  </body>
</html>
